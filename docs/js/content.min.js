const menuContainer=document.getElementById("nav-links-container"),menuIcon=document.getElementById("menu-icon");function toggleMenu(){menuContainer.classList.toggle("open"),updateMenuIcon()}function updateMenuIcon(){menuContainer.classList.contains("open")?(menuIcon.data="img/menu_close.svg",menuContainer.ariaLabel="Close the menu"):(menuIcon.data="img/menu_open.svg",menuContainer.ariaLabel="Open the menu")}document.getElementById("menu-control").addEventListener("click",toggleMenu);const markdownContainer=document.getElementById("markdown-container"),contentContainer=document.getElementById("content-container"),currentUrl=new URL(document.URL);async function loadPage(e){let n;contentContainer.classList.add("loading"),menuContainer.classList.remove("open"),updateMenuIcon(),""!==e.pathname&&"/"!=e.pathname||(e.pathname="/index"),e.pathname="/content"+e.pathname+".md";try{if("cancelled"===(n=await getMarkdown(e)))return}catch{}n||(n="## An unknown error occurred. Could not load page."),n=n.replace(/^[\u200B\u200C\u200D\u200E\u200F\uFEFF]/,""),markdownContainer.innerHTML=marked.parse(n);const t=markdownContainer.getElementsByTagName("A");for(let e=0;e<t.length;e++)t[e].href.startsWith(currentUrl.origin)||(t[e].target="_blank");const r=markdownContainer.getElementsByTagName("IMG");for(let e=0;e<r.length;e++){e>0&&(r[e].loading="lazy");let n=r[e].getAttribute("src");r[e].setAttribute("srcset",n.replace(".png","-small.webp")+" 320w, "+n.replace(".png","-medium.webp")+" 480w,"+n.replace(".png","-regular.webp")+" 640w,"+n.replace(".png","-large.webp")+" 1280w"),r[e].setAttribute("sizes","(max-width: 920px) 80vw, 640px"),r[e].setAttribute("src",n.replace(".png",".webp"))}const a=markdownContainer.children;for(let e=0;e<a.length;e++)1==a[e].children.length&&"IMG"==a[e].children[0].tagName&&a[e].classList.add("img-container");contentContainer.classList.remove("loading")}var abortController;async function getMarkdown(e,n){n||(abortController&&abortController.abort(),abortController=new AbortController);try{let t=await fetch(e,{signal:n?null:abortController.signal});if(t.status>299)throw new Error("Unknown Error");return await t.text()}catch(e){if("AbortError"==e.name)return"cancelled";throw e}}window.addEventListener("click",async function(e){if("A"===e.target.tagName&&e.target.href.startsWith(currentUrl.origin)&&!e.target.target)return e.preventDefault(),history.pushState({url:e.target.href},null,e.target.href),loadPage(new URL(e.target.href)),!1}),window.addEventListener("popstate",async function(e){e.state.url&&loadPage(new URL(e.state.url))}),history.replaceState({url:document.URL},null,document.URL),loadPage(currentUrl);